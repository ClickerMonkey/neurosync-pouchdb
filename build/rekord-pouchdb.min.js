/* rekord-pouchdb 1.5.6 - A rekord binding to pouchdb - implementing Rekord.rest, Rekord.live, & Rekord.store by Philip Diffenderfer */
!function(e,u){"function"==typeof define&&define.amd?define(["rekord","pouchdb"],function(o,n){return u(e,o,n)}):"object"==typeof module&&module.exports?module.exports=u(global,require("rekord"),require("pouchdb")):e.Rekord=u(e,e.Rekord,e.PouchDB)}(this,function(e,u,o,n){function t(e,u){return e in E?E[e]:E[e]=new o(e,u)}function r(e){if(!e.api)return O.call(this,e);e.fullSave=!0,e.cache=u.Cache.None,e.origin=u.uuid();var n=this.pouch(e.name,e.storeOptions),t={include_docs:!0};return o.replicate(e.name,e.api,{live:!0,retry:!0}),u.debug(_.POUCH_INIT,e,n),{pouchdb:n,all:function(o,r,i){function E(o){u.debug(_.POUCH_ALL,e,o);for(var n=[],t=0;t<o.rows.length;t++)n.push(o.rows[t].doc);r(n)}function c(o){u.debug(_.POUCH_ALL_ERROR,e,o),i([],o.status)}var O=t;P(o)&&(O=R(o,a(O))),n.allDocs(O).then(E)["catch"](c)},get:function(o,t,r,i){function E(n){u.debug(_.POUCH_GET,e,o,O,n),o._rev=n._rev,r(n)}function c(n){u.debug(_.POUCH_GET_ERROR,e,o,O,n),i(null,n.status)}var O=String(o.$key());n.get(O).then(E)["catch"](c)},create:function(o,t,r,i,E){function c(n){u.debug(_.POUCH_CREATE,e,o,t,n),n.ok?(o._rev=n.rev,t._rev=n.rev,i({})):E(null,n.status)}function O(n){u.debug(_.POUCH_CREATE_ERROR,e,o,t,n),E(null,n.status)}t._id=String(o.$key()),t.$origin=e.origin,n.put(t).then(c)["catch"](O)},update:function(o,t,r,i,E){function c(n){u.debug(_.POUCH_UPDATE,e,o,t,n),n.ok?(o._rev=n.rev,t._rev=n.rev,i({})):E(null,n.status)}function O(n){u.debug(_.POUCH_UPDATE_ERROR,e,o,t,n),E(null,n.status)}t._id=String(o.$key()),t._rev=o._rev,t.$origin=e.origin,n.put(t).then(c)["catch"](O)},remove:function(o,t,r,i){function E(n){u.debug(_.POUCH_REMOVE,e,o,O,n),n.ok?r({}):i({},n.status)}function c(n){u.debug(_.POUCH_REMOVE_ERROR,e,o,O,n),i({},n.status)}var O=String(o.$key());n.remove(O).then(E)["catch"](c)},query:function(e,u,o,n,t){n([])}}}function i(e){function o(o){o.deleted?(u.debug(_.POUCH_LIVE_REMOVE,e,o),e.liveRemove(o.id)):o.doc.$origin!==e.origin?(u.debug(_.POUCH_LIVE_SAVE,e,o),e.liveSave(o.id,o.doc)):u.debug(_.POUCH_LIVE_SAVE_IGNORE,e,o)}if(!e.api)return c.call(this,e);var n=this.pouch(e.name),t={since:"now",live:!0,include_docs:!0};return n.changes(t).on("change",o),{pouchdb:n,save:u.noop,remove:u.noop}}var _=u.Debugs,E={},c=u.live,O=u.rest,R=(u.store,u.transfer),a=u.copy,P=u.isObject;return _.POUCH_INIT=2e3,_.POUCH_ALL=2001,_.POUCH_ALL_ERROR=2002,_.POUCH_GET=2003,_.POUCH_GET_ERROR=2004,_.POUCH_CREATE=2005,_.POUCH_CREATE_ERROR=2006,_.POUCH_UPDATE=2007,_.POUCH_UPDATE_ERROR=2008,_.POUCH_REMOVE=2009,_.POUCH_REMOVE_ERROR=2010,_.POUCH_LIVE_REMOVE=2011,_.POUCH_LIVE_SAVE=2012,_.POUCH_LIVE_SAVE_IGNORE=2013,u.debugMap&&(u.debugMap[_.POUCH_INIT]="PouchDB Initialized",u.debugMap[_.POUCH_ALL]="PouchDB All",u.debugMap[_.POUCH_ALL_ERROR]="PouchDB All Error",u.debugMap[_.POUCH_GET]="PouchDB Get",u.debugMap[_.POUCH_GET_ERROR]="PouchDB Get Error",u.debugMap[_.POUCH_CREATE]="PouchDB Create",u.debugMap[_.POUCH_CREATE_ERROR]="PouchDB Create Error",u.debugMap[_.POUCH_UPDATE]="PouchDB Update",u.debugMap[_.POUCH_UPDATE_ERROR]="PouchDB Update Error",u.debugMap[_.POUCH_REMOVE]="PouchDB Remove",u.debugMap[_.POUCH_REMOVE_ERROR]="PouchDB Remove Error",u.debugMap[_.POUCH_LIVE_REMOVE]="PouchDB Live Remove",u.debugMap[_.POUCH_LIVE_SAVE]="PouchDB Live Save",u.debugMap[_.POUCH_LIVE_SAVE_IGNORE]="PouchDB Live Save Ignored"),u.pouch=t,u.Rests.Pouch=r,u.setRest(r),u.Lives.Pouch=i,u.setLive(i),u});
//# sourceMappingURL=rekord-pouchdb.min.js.map
