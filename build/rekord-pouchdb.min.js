/* rekord-pouchdb 1.4.3 - A rekord binding to pouchdb - implementing Rekord.rest, Rekord.live, & Rekord.store by Philip Diffenderfer */
!function(e,u){"function"==typeof define&&define.amd?define(["rekord","pouchdb"],function(o,n){return u(e,o,n)}):"object"==typeof module&&module.exports?module.exports=u(global,require("rekord"),require("pouchdb")):e.Rekord=u(e,e.Rekord,e.PouchDB)}(this,function(e,u,o,n){function t(e,u){return e in E?E[e]:E[e]=new o(e,u)}function r(e){if(!e.api)return O.call(this,e);e.fullSave=!0,e.cache=u.Cache.None,e.origin=u.uuid();var n=this.pouch(e.name,e.storeOptions),t={include_docs:!0};return o.replicate(e.name,e.api,{live:!0,retry:!0}),u.debug(i.POUCH_INIT,e,n),{pouchdb:n,all:function(o,r){function _(n){u.debug(i.POUCH_ALL,e,n);for(var t=[],r=0;r<n.rows.length;r++)t.push(n.rows[r].doc);o(t)}function E(o){u.debug(i.POUCH_ALL_ERROR,e,o),r([],o.status)}n.allDocs(t).then(_)["catch"](E)},get:function(o,t,r){function _(n){u.debug(i.POUCH_GET,e,o,c,n),o._rev=n._rev,t(n)}function E(n){u.debug(i.POUCH_GET_ERROR,e,o,c,n),r(null,n.status)}var c=String(o.$key());n.get(c).then(_)["catch"](E)},create:function(o,t,r,_){function E(n){u.debug(i.POUCH_CREATE,e,o,t,n),n.ok?(o._rev=n.rev,t._rev=n.rev,r({})):_(null,n.status)}function c(n){u.debug(i.POUCH_CREATE_ERROR,e,o,t,n),_(null,n.status)}t._id=String(o.$key()),t.$origin=e.origin,n.put(t).then(E)["catch"](c)},update:function(o,t,r,_){function E(n){u.debug(i.POUCH_UPDATE,e,o,t,n),n.ok?(o._rev=n.rev,t._rev=n.rev,r({})):_(null,n.status)}function c(n){u.debug(i.POUCH_UPDATE_ERROR,e,o,t,n),_(null,n.status)}t._id=String(o.$key()),t._rev=o._rev,t.$origin=e.origin,n.put(t).then(E)["catch"](c)},remove:function(o,t,r){function _(n){u.debug(i.POUCH_REMOVE,e,o,c,n),n.ok?t({}):r({},n.status)}function E(n){u.debug(i.POUCH_REMOVE_ERROR,e,o,c,n),r({},n.status)}var c=String(o.$key());n.remove(c).then(_)["catch"](E)},query:function(e,u,o,n){o([])}}}function _(e){function o(o){o.deleted?(u.debug(i.POUCH_LIVE_REMOVE,e,o),e.liveRemove(o.id)):o.doc.$origin!==e.origin?(u.debug(i.POUCH_LIVE_SAVE,e,o),e.liveSave(o.id,o.doc)):u.debug(i.POUCH_LIVE_SAVE_IGNORE,e,o)}if(!e.api)return c.call(this,e);var n=this.pouch(e.name),t={since:"now",live:!0,include_docs:!0};return n.changes(t).on("change",o),{pouchdb:n,save:u.noop,remove:u.noop}}var i=u.Debugs,E={},c=u.live,O=u.rest;u.store;return i.POUCH_INIT=2e3,i.POUCH_ALL=2001,i.POUCH_ALL_ERROR=2002,i.POUCH_GET=2003,i.POUCH_GET_ERROR=2004,i.POUCH_CREATE=2005,i.POUCH_CREATE_ERROR=2006,i.POUCH_UPDATE=2007,i.POUCH_UPDATE_ERROR=2008,i.POUCH_REMOVE=2009,i.POUCH_REMOVE_ERROR=2010,i.POUCH_LIVE_REMOVE=2011,i.POUCH_LIVE_SAVE=2012,i.POUCH_LIVE_SAVE_IGNORE=2013,u.debugMap&&(u.debugMap[i.POUCH_INIT]="PouchDB Initialized",u.debugMap[i.POUCH_ALL]="PouchDB All",u.debugMap[i.POUCH_ALL_ERROR]="PouchDB All Error",u.debugMap[i.POUCH_GET]="PouchDB Get",u.debugMap[i.POUCH_GET_ERROR]="PouchDB Get Error",u.debugMap[i.POUCH_CREATE]="PouchDB Create",u.debugMap[i.POUCH_CREATE_ERROR]="PouchDB Create Error",u.debugMap[i.POUCH_UPDATE]="PouchDB Update",u.debugMap[i.POUCH_UPDATE_ERROR]="PouchDB Update Error",u.debugMap[i.POUCH_REMOVE]="PouchDB Remove",u.debugMap[i.POUCH_REMOVE_ERROR]="PouchDB Remove Error",u.debugMap[i.POUCH_LIVE_REMOVE]="PouchDB Live Remove",u.debugMap[i.POUCH_LIVE_SAVE]="PouchDB Live Save",u.debugMap[i.POUCH_LIVE_SAVE_IGNORE]="PouchDB Live Save Ignored"),u.pouch=t,u.setRest(r),u.setLive(_),u});
//# sourceMappingURL=rekord-pouchdb.min.js.map
